<div
  class='op-merge-request--title'
  [textContent]="mergeRequest.title"
></div>

<span class='op-merge-request--state' [ngClass]="'op-merge-request--state_' + state">
  <svg class="op-merge-request--iconsize"><use [attr.xlink:href]="'#merge-request_' + state" /></svg>
  {{state}} | 
  <a
  [ngClass]="'op-merge-request--link' + state"
  [href]="mergeRequest.htmlUrl"
  target="blank"
  [textContent]="mergeRequest.repository + '#' + mergeRequest.number"
  ></a>
</span>

<div class="op-merge-request--info_created">
  {{ text.label_created_by }}
  <img
    alt='MR author avatar'
    class='op-merge-request--avatar op-avatar op-avatar_mini'
    [src]="mergeRequest.gitlabUser.avatarUrl"
    *ngIf="mergeRequest.gitlabUser"
  />&nbsp;
  <span class='op-merge-request--user'> 
    <a
      [href]="'mailto:' + mergeRequest.gitlabUser.email"
      class='op-merge-request--username'
      [textContent]="mergeRequest.gitlabUser.login"
      *ngIf="mergeRequest.gitlabUser"
    ></a>.
  </span>
</div>

<div class="op-merge-request--info_updated">
  <span class='op-merge-request--date'>
    {{ text.label_last_updated_on }}
    <op-date-time [dateTimeValue]="mergeRequest.gitlabUpdatedAt"></op-date-time>
  </span>.
</div>

<div class="op-merge-request--labels">
  <span *ngFor="let label of mergeRequest.labels">
    <span class='op-merge-request--label' [ngStyle]="{'background-color': label.color}" >
      {{label.title}}
    </span>
  </span>
</div>

<span class="op-merge-request--pipeline-label"  *ngIf="mergeRequest.pipelines?.length">{{ text.label_pipelines }}</span>

<ul [attr.aria-label]="text.label_pipelines" class='op-merge-request--pipeline' *ngIf="mergeRequest.pipelines?.length">
  <li class='op-mr-pipeline' *ngFor="let pipeline of mergeRequest.pipelines">
    <span class='op-mr-pipeline--state-icon' [ngClass]="'op-mr-pipeline--state-icon_' + pipelineState(pipeline)">
      <op-icon icon-classes="icon-{{ pipelineStateIcon(pipeline) }}"
               [icon-title]="pipelineStateText(pipeline)"></op-icon>
    </span>

    <span class='op-mr-pipeline--info'>Merge request pipeline <a [href]="pipeline.htmlUrl">#{{ pipeline.name }}</a> {{ pipelineStateText(pipeline) }} for <a [href]="pipeline.detailsUrl">#{{ pipeline.commitId }}</a></span>

    <span class='op-mr-pipeline--avatar'><img alt='user owner avatar' [src]="pipeline.userAvatarUrl" /> {{ pipeline.username }}</span>

    <!-- <span class='op-mr-pipeline--details'>
      <a [href]="pipeline.detailsUrl">
        {{ text.label_details }}
      </a>
    </span> -->
  </li>
</ul>
